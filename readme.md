# FTPLibrary
A simple FTP client created for the use of my FTPLibrary. [archival]

This is an old project of mine, that I created back in 2005.<br/>
Imported into GitHub for archival puposes only.<br/>
There will be no updates.

<h2>Introduction</h2><p>Experimenting with Visual Studio 2005 I discovered that .NET Framework 2.0 included a new class called <code>FtpWebRequest</code>. </p><p>I was in need of a way to transfer some files programmatically to an FTP server, so I decided to take a closer look at this class. </p><p>The FtpWebRequest class is very straightforward to use, but it provides only the bare minimum to access an FTP server. </p><p>So I decided to roll up my sleeve and put something together in order to use this class and help me in my little project. </p><h2>Creating the Class</h2><p>Because I was just experimenting with this new class I decided to keep my implementation simple. </p><p>My class would only do four things on the FTP server:</p><ol><li>Retrieve the current directory. </li><li>Upload a File</li><li>Download a File</li><li>Delete a File</li></ol><p>Everything else at this time would be superfluous.</p><p>The only compromise I did against simplicity is that my class would perform all the operations both synchronous and asynchronously. </p><h3>Synchronous and Asynchronous mode</h3><p>Every method on the <strong>ftpClass</strong> is synchronous. The difference between both modes is that in the asynchronous mode events are fired in the beginning, during, and on the completion of an operation. </p><h3>Future Improvements</h3><p>There are thousands of items that I'd like to add in this class in the future. Among many others the main points are: </p><ul class="flower"><li>Cancel an ongoing operation</li><li>Ability to handle multiple Uploads and Downloads</li><li>Resume broken Uploads and Downloads</li><li>Better error handling and event definitions</li><li>Multiple connections</li><li>etc...</li></ul><h2>ftpClient Members</h2><h3>Public Enumerators</h3><p><table id="table1" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Constructor" src="http://pjondevelopment.50webs.com/images/class/enum.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>AttributeFlags</code><br />A mask of bits that represents the permission for each file and folder on the FTP server. <pre class="vb" xml:space="preserve">Public Enum AttributeFlags As UShort&#13;    Directory     = &amp;H800&#13;    OwnerRead     = &amp;H100&#13;    OwnerWrite    = &amp;H80&#13;    OwnerExecute  = &amp;H40&#13;    GroupRead     = &amp;H20&#13;    GroupWrite    = &amp;H10&#13;    GroupExecute  = &amp;H8&#13;    PublicRead    = &amp;H4&#13;    PublicWrite   = &amp;H2&#13;    PublicExecute = &amp;H1&#13;    None          = 0&#13;End Enum</pre></td></tr></tbody></table></p><p /><h3>Public Constructors</h3><p><table id="table2" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Constructor" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>ftpClient Constructor</code><br />Initializes a new instance of the <b>ftpClient</b> Class. <pre class="vb" xml:space="preserve">Public Sub New()&#13;&#13;Public Sub New(ByVal Server As System.Uri)&#13;&#13;Public Sub New(ByVal Server As System.Uri, _&#13;               ByVal UserCredentials As _&#13;                        System.Net.NetworkCredential)&#13;&#13;Public Sub New(ByVal Server As String, _&#13;               ByVal Port As Integer)&#13;&#13;Public Sub New(ByVal Server As String, _&#13;               ByVal Port As Integer, _&#13;               ByVal UserName As String, _&#13;               ByVal Password As String)</pre></td></tr></tbody></table></p><p /><h3>Public Properties</h3><p><table id="table3" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>AllowUserInput</code><br />Gets or sets a System.Boolean that specifies that in case of unknown FTP servers a window will be displayed to the user to request information in order to improve the FTP Library. Default <code>True</code>. <pre class="vb" xml:space="preserve">Public Property AllowUserInput() As Boolean</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Async</code><br />Gets of sets if the data transfer will be conducted asynchronously. Default <code>False</code>. <pre class="vb" xml:space="preserve">Public Property Async() As Boolean</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>BufferSize</code><br />The size, in bytes, of the buffer used during data transfers. Default 1024 bytes.<br /><pre class="vb" xml:space="preserve">Public Property BufferSize() As Integer </pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Busy</code><br /><b>ReadOnly</b>.<br />Indicates if the instance of the ftpClient class is transferring data.<br /><pre class="vb" xml:space="preserve">Public ReadOnly Property Busy() As Boolean</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>FileList</code><br /><strong>ReadOnly.</strong><br />An ftpDirectory instance that stores the list of files and folders of the current Path on the FTP server.<br /><pre class="vb" xml:space="preserve">Public ReadOnly Property FileList() As ftpDirectory</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Path</code><br />The current path on the server.<br /><pre class="vb" xml:space="preserve">Public Property Path() As String</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Server</code><br />A System.Uri instance that represents the FTP server.<br /><pre class="vb" xml:space="preserve">Public Property Server() As System.Uri</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>StatusCode</code><br /><strong>ReadOnly.</strong><br />A numeric code indicating the last response from the server. More information can be obtained in the RFC959.<br /><pre class="vb" xml:space="preserve">Public ReadOnly Property StatusCode() As _&#13;                            System.Net.FtpStatusCode</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>StatusDescription</code><br />The human-readable description of the StatusCode.<br /><pre class="vb" xml:space="preserve">Public ReadOnly Property StatusDescription() _&#13;                                          As String</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>UserCredentials</code><br />A NetworkCredential instance that represents the FTP User Account used to log in the remote server.<br /><pre class="vb" xml:space="preserve">Public Property UserCredentials() As _&#13;                        System.Net.NetworkCredential</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>UseSSL</code><br />Gets or sets a System.Boolean that specifies that an SSL connection should be used.<br /><pre class="vb" xml:space="preserve">Public Property UseSSL() As Boolean</pre></td></tr></tbody></table></p><p /><h3>Public Methods</h3><p><table id="table4" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>DeleteFile</code><br />Deletes a file on the Server. After calling this method is necessary to call the <code>Refresh</code> method to ensure that the <code>FileList</code> property is up to date.<pre class="vb" xml:space="preserve">Public Overloads Sub DeleteFile(ByVal FileName _&#13;                                           As String)&#13;&#13;Public Overloads Sub DeleteFile(ByVal File _&#13;                                          As ftpFile)</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>DownloadFile</code><br />Download a file from the FTP server. <pre class="vb" xml:space="preserve">Public Overloads Sub DownloadFile( _&#13;                  ByVal RemoteFileName As String, _&#13;         Optional ByVal LocalFileName As String = &quot;&quot;)&#13;&#13;Public Overloads Sub DownloadFile( _&#13;                  ByVal RemoteFileName As String, _&#13;                  ByVal LocalStream As _&#13;                                   System.IO.Stream)&#13;&#13;Public Overloads Sub DownloadFile( _&#13;                  ByVal RemoteFile As ftpFile, _&#13;         Optional ByVal LocalFileName As String = &quot;&quot;)&#13;&#13;Public Overloads Sub DownloadFile( _&#13;                  ByVal RemoteFile As ftpFile, _&#13;                  ByVal LocalStream As _&#13;                                   System.IO.Stream)</pre><strong>Note:</strong> When calling any of the overloaded <code>DownloadFile</code> method that accepts a Stream is the responsibility of the caller to close the stream upon the completion of the operation. </td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>Refresh</code><br />Updates the FileList with fresh information from the FTP server. <pre class="vb" xml:space="preserve">Public Sub Refresh()</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>UploadFile</code><br />Upload a file or a stream to the FTP server. <pre class="vb" xml:space="preserve">Public Overloads Sub UploadFile( _&#13;                ByVal LocalFileName As String, _&#13;       Optional ByVal RemoteFileName As String = &quot;&quot;)&#13;&#13;Public Overloads Sub UploadFile( _&#13;                ByVal LocalStream As _&#13;                                 System.IO.Stream, _&#13;                ByVal RemoteFileName As String)</pre><strong>Note:</strong> When calling the overloaded <code>UploadFile</code> method that accepts a Stream is the responsibility of the caller to close the stream upon the completion of the operation. </td></tr></tbody></table></p><p /><h3>Public Events</h3><p><table id="Table5" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Constructor" src="http://pjondevelopment.50webs.com/images/class/event.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>onBeforeRequest</code><br />Called before any request is made. <pre class="vb" xml:space="preserve">Public Event onBeforeRequest( _&#13;                ByVal sender As Object, _&#13;                ByVal e As EventArgs)</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Constructor" src="http://pjondevelopment.50webs.com/images/class/event.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>onRequestComplete</code><br />Called on the completion of a request. <pre class="vb" xml:space="preserve">Public Event onRequestComplete( _&#13;                ByVal sender As Object, _&#13;                ByVal e As EventArgs)</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Constructor" src="http://pjondevelopment.50webs.com/images/class/event.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>onRequestProgress</code><br />Called during request to inform the main thread of the progress. <pre class="vb" xml:space="preserve">Public Event onRequestProgress( _&#13;                ByVal sender As Object, _&#13;                ByVal e As RequestProgressEventArgs)</pre></td></tr></tbody></table></p><p /><h3>RequestProgressEventArgs</h3><h4>Public Properties</h4><p><table id="Table6" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>BytesReceived</code><br /><strong>ReadOnly.</strong><br />The number of the bytes received on this request.<br /><pre class="vb" xml:space="preserve">Public ReadOnly Property BytesReceived() As Integer</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>BytesSent</code><br /><strong>ReadOnly.</strong><br />The number of the bytes sent on this request.<br /><pre class="vb" xml:space="preserve">Public ReadOnly Property BytesSent() As Integer</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>BytesTotal</code><br /><strong>ReadOnly.</strong><br />The total amount of bytes expected to be sent or received.<br /><pre class="vb" xml:space="preserve">Public ReadOnly Property BytesTotal() As Integer</pre></td></tr></tbody></table></p><p /><h2>ftpDirectory Members</h2><h5>Inherits ArrayList</h5><h3>Public Properties</h3><table id="Table7" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Item</code><br />Returns an ftpFile object.<br /><pre class="vb" xml:space="preserve">Public Shadows Property Item(ByVal Index As Integer) _&#13;                                          As ftpFile</pre></td></tr></tbody></table><br /><h2>ftpFile Members</h2><h3>Public Properties</h3><p><table id="Table8" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/field.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Date</code><br />The timestamp of the file.<br /><pre class="vb" xml:space="preserve">Public [Date] As DateTime</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/field.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Name</code><br />The name of the file or folder.<br /><pre class="vb" xml:space="preserve">Public Name As String</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/field.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Owner</code><br />The owner of the file or folder. If available.<br /><pre class="vb" xml:space="preserve">Public Owner As String</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/field.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Size</code><br />The size of the file in bytes. Folders always have size 0.<br /><pre class="vb" xml:space="preserve">Public Size As ULong</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Property" src="http://pjondevelopment.50webs.com/images/class/property.gif" width="16" height="16" /></td><td class="Definition" vAlign="top"><code>Flags</code><br />A map of bits that represents the attributes of the file or folder.<br /><pre class="vb" xml:space="preserve">Public Property Flags() As AttributeFlags</pre></td></tr></tbody></table></p><p /><h3>Public Methods</h3><p><table id="Table9" class="Members" border="1" rules="rows" cellSpacing="0" cellPadding="2"><tbody><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>CanGroupExecute<br />CanGroupRead<br />CanGroupWrite<br /></code>Returns a System.Boolean that indicates if the group can execute, read, or write the file. <pre class="vb" xml:space="preserve">Public Function CanGroupExecute() As Boolean&#13;Public Function CanGroupRead() As Boolean&#13;Public Function CanGroupWrite() As Boolean</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>CanOwnerExecute<br />CanOwnerRead<br />CanOwnerWrite<br /></code>Returns a System.Boolean that indicates if the Owner can execute, read, or write the file. <pre class="vb" xml:space="preserve">Public Function CanOwnerExecute() As Boolean&#13;Public Function CanOwnerRead() As Boolean&#13;Public Function CanOwnerWrite() As Boolean</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>CanPublicExecute<br />CanPublicRead<br />CanPublicWrite<br /></code>Returns a System.Boolean that indicates if the Public can execute, read, or write the file. <pre class="vb" xml:space="preserve">Public Function CanPublicExecute() As Boolean&#13;Public Function CanPublicRead() As Boolean&#13;Public Function CanPublicWrite() As Boolean</pre></td></tr><tr><td class="Icon" vAlign="top" align="center"><img alt="Public Method" src="http://pjondevelopment.50webs.com/images/class/method.gif" width="16" height="16" /></td><td class="Definition"><code>IsDirectory</code><br />Returns a System.Boolean that indicates if this instance of ftpFile Class is a folder (or directory). <pre class="vb" xml:space="preserve">Public Function IsDirectory() As Boolean</pre></td></tr></tbody></table></p>

